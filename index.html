<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NFC Tag Reader/Writer</title><style>body{font-family:Arial,sans-serif}#nfc-dialog{display:none;border:1px solid #ccc;padding:20px;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;z-index:1000}#nfc-dialog.open{display:block}</style><script defer="defer" src="/react-nfc-hook/static/js/main.be3735a7.js"></script><link href="/react-nfc-hook/static/css/main.e6c13ad2.css" rel="stylesheet"></head><body><h1>NFC Tag Reader/Writer</h1><div><label for="name">Name:</label> <input id="name"></div><div><label for="age">Age:</label> <input id="age"></div><div><label for="city">City:</label> <input id="city"></div><button id="scan">Scan NFC Tag</button> <button id="stop-scan">Stop Scan</button> <button id="write">Write to NFC Tag</button><div id="nfc-dialog"><p id="dialog-body"></p><button id="close-dialog">Close</button></div><script>const scanButton=document.querySelector("#scan"),stopScanButton=document.querySelector("#stop-scan"),writeButton=document.querySelector("#write"),name=document.querySelector("#name"),age=document.querySelector("#age"),city=document.querySelector("#city"),nfcDialog=document.querySelector("#nfc-dialog"),closeButton=document.querySelector("#close-dialog");let scanning=!1;closeButton.addEventListener("click",(()=>{nfcDialog.classList.remove("open")})),stopScanButton.disabled=!0;const capitalize=e=>`${e.substr(0,1).toUpperCase()}${e.substr(1)}`,showTagData=e=>{document.querySelector("#dialog-body").innerHTML=[...Object.entries(e)].reduce(((e,[t,n])=>`${e}<p>${capitalize(t)}: ${n}</p>`),""),nfcDialog.classList.add("open")},readTag=({message:e})=>{const{records:t}=e;return t.map((e=>{const{id:t,recordType:n,mediaType:o,encoding:a,data:r}=e,c=a?new TextDecoder(a):new TextDecoder;switch(n){case"url":case"text":console.log("data",c.decode(r));break;case"mime":showTagData(JSON.parse(c.decode(r)))}return["url","text"].includes(n)?c.decode(r):JSON.parse(c.decode(r))}))};let abortController;const scanTag=()=>(scanButton.disabled=!0,stopScanButton.disabled=!1,new Promise(((e,t)=>{try{const n=new NDEFReader;abortController=new AbortController,n.scan({signal:abortController.signal}),scanning=!0,n.addEventListener("reading",(t=>e(readTag(t)))),n.addEventListener("readingerror",(e=>{console.log("error reading tag",e),t(e)}))}catch(e){console.log("error scanning tag:",e),scanButton.disabled=!1,stopScanButton.disabled=!0,scanning=!1,t(e)}}))),stopScan=()=>{abortController.abort(),scanButton.disabled=!1,stopScanButton.disabled=!0,scanning=!1},writeTag=async()=>{writeButton.disabled=!0,scanning&&stopScan();const e=new TextEncoder,t={name:name.value,age:age.value,city:city.value},n=[];n.push({recordType:"mime",mediaType:"application/json",data:e.encode(JSON.stringify(t))});const o=new NDEFReader;abortController=new AbortController,o.scan({signal:abortController.signal});try{await o.write({records:n},{overwrite:!0}),setTimeout((()=>abortController.abort()),3e3)}catch(e){console.log("error writing tag",e)}finally{writeButton.disabled=!1}};scanButton.addEventListener("click",scanTag),stopScanButton.addEventListener("click",stopScan),writeButton.addEventListener("click",writeTag)</script></body></html>